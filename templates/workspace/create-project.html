{% extends 'base.html' %}
{% load static %}

{% block title %}Create Project - {{ workspace.name }}{% endblock %}

{% block extra_css %}
<style>
.form-color {
    height: 2.5rem;
    width: 3rem;
    padding: 0;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    cursor: pointer;
}
.form-color:focus {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
}
</style>
{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="mb-6">
        <h1>Create New Project</h1>
        <p class="text-gray-600">Add a new project to "{{ workspace.name }}"</p>
    </div>

    <!-- ✅ Django Messages (success/error) -->
    {% if messages %}
    <div class="mb-6">
        {% for message in messages %}
            <div class="bg-{{ message.tags|default:'info' }}-100 border-l-4 border-{{ message.tags|default:'info' }}-500 text-{{ message.tags|default:'info' }}-700 p-4 rounded mb-4">
                {{ message }}
            </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- ✅ Form Errors -->
    {% if form.non_field_errors %}
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
        {{ form.non_field_errors }}
    </div>
    {% endif %}

    <div class="card">
        <div class="card-body">
            <form method="post">
                {% csrf_token %}
                
                <!-- Project Name -->
                <div class="form-group">
                    <label class="form-label" for="{{ form.name.id_for_label }}">Project Name</label>
                    {{ form.name }}
                    {% if form.name.errors %}
                        <div class="text-red-500 text-sm mt-1">
                            {{ form.name.errors }}
                        </div>
                    {% endif %}
                </div>

                <!-- Description -->
                <div class="form-group mt-4">
                    <label class="form-label" for="{{ form.description.id_for_label }}">Description (Optional)</label>
                    {{ form.description }}
                    {% if form.description.errors %}
                        <div class="text-red-500 text-sm mt-1">
                            {{ form.description.errors }}
                        </div>
                    {% endif %}
                </div>

                <!-- Color Picker -->
                <div class="form-group mt-4">
                    <label class="form-label" for="{{ form.color.id_for_label }}">Project Color</label>
                    <div class="flex items-center gap-3">
                        {{ form.color }}
                        <span id="color-preview" class="w-8 h-8 rounded border border-gray-300" 
                              style="background-color: {{ form.color.value|default:'#3B82F6' }};"></span>
                    </div>
                    {% if form.color.errors %}
                        <div class="text-red-500 text-sm mt-1">
                            {{ form.color.errors }}
                        </div>
                    {% endif %}
                </div>

                <!-- Submit Buttons -->
                <div class="mt-8 flex gap-3">
                    <button type="submit" class="btn btn-primary">
                        Create Project
                    </button>
                    <a href="{% url 'workspace:workspace-detail' workspace.id %}" class="btn btn-outline">
                        Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Update color preview when color changes
    const colorInput = document.getElementById('{{ form.color.id_for_label }}');
    const colorPreview = document.getElementById('color-preview');
    
    if (colorInput && colorPreview) {
        colorInput.addEventListener('input', function() {
            colorPreview.style.backgroundColor = this.value;
        });
    }
});
</script>
{% endblock %}